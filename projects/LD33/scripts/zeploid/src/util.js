base.registerModule("util",function(t){function i(t,n){if(t instanceof Array&&n instanceof Array&&t.length==n.length){for(var e=0;e<t.length;e++)if(!i(t[e],n[e]))return!1;return!0}return t==n}function e(t,n){return Math.floor(Math.random()*(n-t+1))+t}t.invalidNum=function(t){return isNaN(t)||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY},t.trace=function(e,i){return function(){var t=(new Date).getTime();i.apply(this,arguments);var n=(new Date).getTime();console.log("function '"+e+"' took"+(n-t)/1e3+"seconds")}},t.randChoice=function(t){for(var n=0;n<10;n++)console.log(e(0,t.length));return t[e(0,t.length-1)]},t.randInt=e,t.randDegree=function(){return util.randInt(0,359)},t.copyArray=function(t){for(var n=[],e=0;e<t.length;e++)n[e]=t[e];return n};var r=base.extend(Object,"Vector",{constructor:function(t,n){this.init(t,n)},_x:null,_y:null,_m:null,_d:null,init:function(t,n){this.live=!0,void 0!==t&&(this._x=t,this._y=n,this.updateMd())},updateMd:function(){var t=this._x,n=this._y;this._m=Math.sqrt(t*t+n*n),this._d=Math.atan2(n,t)*o},updateXy:function(){this._x=Math.cos(this.d*n)*this.m,this._y=Math.sin(this.d*n)*this.m},add:function(t){return r.get(this.x+t.x,this.y+t.y)},sub:function(t){return r.get(this.x-t.x,this.y-t.y)},opposite:function(){return r.get(-this.x,-this.y)},increment:function(t){this.x+=t.x,this.y+=t.y},scale:function(t){return r.get(this.x*t,this.y*t)},toString:function(){return"{x: "+this.x+", y: "+this.y+", m: "+this.m+", d: "+this.d+"}"}});(t.Vector=r).firstPool=null,r.get=function(t,n){if(null===r.firstPool)return new r(t,n);var e=r.firstPool;return r.firstPool=e.x,e.init(t,n),e},r.recycle=function(t){if(!t.live)throw new Error("attempt to recycle a vector twice");t.live=!1,t.x=r.firstPool,t.live=!1,r.firstPool=t},r.createMd=function(t,n){var e=new r;return e.m=t,e.d=n,e},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.updateMd()}}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.updateMd()}}),Object.defineProperty(r.prototype,"m",{get:function(){return this._m},set:function(t){this._m=t,this.updateXy()}}),Object.defineProperty(r.prototype,"d",{get:function(){return this._d},set:function(t){this._d=t,this.updateXy()}});var o=180/Math.PI,n=1/o;Dictionary=base.extend(Object,"Dictionary ",{constructor:function(){this.entries=[]},entries:null,get:function(t){return this.getEntry(t).value},contains:function(t){return null!==this.getEntry(t)},put:function(t,n){var e=this.getEntry(t);null===e?(e=new u(t,n),this.entries.push(e)):e.value=n},length:function(){return this.entries.length},getEntry:function(t){for(var n=0;n<this.entries.length;n++){var e=this.entries[n];if(i(e.key,t))return e}return null}}),t.Dictionary=Dictionary;var u=base.extend(Object,"Entry",{constructor:function(t,n){this.key=t,this.value=n},key:null,value:null}),s=base.extend(Object,"Rect",{constructor:function(t,n,e,i){this.left=t,this.top=n,this.width=e,this.height=i},left:null,top:null,width:null,height:null,collidepoint:function(t,n){return this.left<t&&this.top<n&&t<this.right&&n<this.bottom},colliderect:function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top}});function h(t,n){Object.defineProperty(s.prototype,t,{get:n})}t.Rect=s,h("right",function(){return this.left+this.width}),h("bottom",function(){return this.top+this.height})});