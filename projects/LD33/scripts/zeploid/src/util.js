base.registerModule("util",function(t){function n(t){return isNaN(t)||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY}function e(t,n){if(t instanceof Array&&n instanceof Array&&t.length==n.length){for(var i=0;i<t.length;i++)if(!e(t[i],n[i]))return!1;return!0}return t==n}function i(t,n){return Math.floor(Math.random()*(n-t+1))+t}function r(t,n){Object.defineProperty(c.prototype,t,{get:n})}t.invalidNum=n,t.trace=function(t,n){return function(){var e=(new Date).getTime();n.apply(this,arguments);var i=(new Date).getTime();console.log("function '"+t+"' took"+(i-e)/1e3+"seconds")}},t.randChoice=function(t){for(var n=0;10>n;n++)console.log(i(0,t.length));return t[i(0,t.length-1)]},t.randInt=i,t.randDegree=function(){return util.randInt(0,359)},t.copyArray=function(t){for(var n=[],e=0;e<t.length;e++)n[e]=t[e];return n};var o=base.extend(Object,"Vector",{constructor:function(t,n){this.init(t,n)},_x:null,_y:null,_m:null,_d:null,init:function(t,n){this.live=!0,"undefined"!=typeof t&&(this._x=t,this._y=n,this.updateMd())},updateMd:function(){var t=this._x,n=this._y;this._m=Math.sqrt(t*t+n*n),this._d=Math.atan2(n,t)*u},updateXy:function(){this._x=Math.cos(this.d*s)*this.m,this._y=Math.sin(this.d*s)*this.m},add:function(t){return o.get(this.x+t.x,this.y+t.y)},sub:function(t){return o.get(this.x-t.x,this.y-t.y)},opposite:function(){return o.get(-this.x,-this.y)},increment:function(t){this.x+=t.x,this.y+=t.y},scale:function l(l){return o.get(this.x*l,this.y*l)},toString:function(){return"{x: "+this.x+", y: "+this.y+", m: "+this.m+", d: "+this.d+"}"}});t.Vector=o,o.firstPool=null,o.get=function(t,n){if(null===o.firstPool)return new o(t,n);var e=o.firstPool;return o.firstPool=e.x,e.init(t,n),e},o.recycle=function(t){if(!t.live)throw new Error("attempt to recycle a vector twice");t.live=!1,t.x=o.firstPool,t.live=!1,o.firstPool=t},o.createMd=function(t,n){var e=new o;return e.m=t,e.d=n,e},Object.defineProperty(o.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.updateMd()}}),Object.defineProperty(o.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.updateMd()}}),Object.defineProperty(o.prototype,"m",{get:function(){return this._m},set:function(t){this._m=t,this.updateXy()}}),Object.defineProperty(o.prototype,"d",{get:function(){return this._d},set:function(t){this._d=t,this.updateXy()}});const u=180/Math.PI,s=1/u;Dictionary=base.extend(Object,"Dictionary ",{constructor:function(){this.entries=[]},entries:null,get:function(t){return this.getEntry(t).value},contains:function(t){return null!==this.getEntry(t)},put:function(t,n){var e=this.getEntry(t);null===e?(e=new h(t,n),this.entries.push(e)):e.value=n},length:function(){return this.entries.length},getEntry:function(t){for(var n=0;n<this.entries.length;n++){var i=this.entries[n];if(e(i.key,t))return i}return null}}),t.Dictionary=Dictionary;var h=base.extend(Object,"Entry",{constructor:function(t,n){this.key=t,this.value=n},key:null,value:null}),c=base.extend(Object,"Rect",{constructor:function(t,n,e,i){this.left=t,this.top=n,this.width=e,this.height=i},left:null,top:null,width:null,height:null,collidepoint:function(t,n){return this.left<t&&this.top<n&&t<this.right&&n<this.bottom},colliderect:function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top}});t.Rect=c,r("right",function(){return this.left+this.width}),r("bottom",function(){return this.top+this.height})});